Below is the complete code that you provided, arranged according to the structure of each topic.

---

### **1. Collections: Ticket Booking System Using Map**

```java
import java.util.*;

class TicketBooking {
    Map<String, String> map = new HashMap<>();

    public void addTicketBookingDetails(String seatNumber, String ticketType) {
        map.put(seatNumber, ticketType);
    }

    public int findTotalCountOfSeatNumbersBasedOnTicketType(String ticketType) {
        int count = 0;
        for (String value : map.values()) {
            if (value.equalsIgnoreCase(ticketType)) {
                count++;
            }
        }
        return count;
    }

    public List<String> searchSeatNumbersByTicketType(String ticketType) {
        List<String> seatNumbersList = new ArrayList<>();
        for (Map.Entry<String, String> entry : map.entrySet()) {
            if (entry.getValue().equalsIgnoreCase(ticketType)) {
                seatNumbersList.add(entry.getKey());
            }
        }
        return seatNumbersList;
    }
}

public class UserInterface {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        TicketBooking ticketBooking = new TicketBooking();

        System.out.println("Enter the number of booking entries: ");
        int n = scanner.nextInt();
        scanner.nextLine();

        for (int i = 0; i < n; i++) {
            System.out.println("Enter seat number:");
            String seatNumber = scanner.nextLine();
            System.out.println("Enter ticket type:");
            String ticketType = scanner.nextLine();
            ticketBooking.addTicketBookingDetails(seatNumber, ticketType);
        }

        System.out.println("Enter ticket type to find the seat numbers:");
        String ticketType = scanner.nextLine();
        List<String> seatNumbers = ticketBooking.searchSeatNumbersByTicketType(ticketType);
        System.out.println("Seat Numbers: " + seatNumbers);

        System.out.println("Enter ticket type to find the total count:");
        ticketType = scanner.nextLine();
        int count = ticketBooking.findTotalCountOfSeatNumbersBasedOnTicketType(ticketType);
        System.out.println("Total Count of Seats: " + count);
    }
}
```

---

### **2. Exception Handling: Account Linking Validation**

```java
import java.util.regex.*;

class InvalidAccountDetailsException extends Exception {
    public InvalidAccountDetailsException(String message) {
        super(message);
    }
}

class AccountLinkingSystem {

    public void validateAccountDetails(String accountNumber, String aadharNumber, String panNumber) throws InvalidAccountDetailsException {
        if (!accountNumber.matches("\\d{10}")) {
            throw new InvalidAccountDetailsException("Invalid Account Number");
        }
        if (!aadharNumber.matches("\\d{12}")) {
            throw new InvalidAccountDetailsException("Invalid Aadhar Number");
        }
        if (!panNumber.matches("[A-Z]{5}\\d{4}[A-Z]{1}")) {
            throw new InvalidAccountDetailsException("Invalid PAN Number");
        }
        System.out.println("Success");
    }
}

public class UserInterface {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        AccountLinkingSystem accountLinkingSystem = new AccountLinkingSystem();

        System.out.println("Enter Account Number:");
        String accountNumber = scanner.nextLine();
        System.out.println("Enter Aadhar Number:");
        String aadharNumber = scanner.nextLine();
        System.out.println("Enter PAN Number:");
        String panNumber = scanner.nextLine();

        try {
            accountLinkingSystem.validateAccountDetails(accountNumber, aadharNumber, panNumber);
        } catch (InvalidAccountDetailsException e) {
            System.out.println(e.getMessage());
        }
    }
}
```

---

### **3. Streams: Book Management System**

```java
import java.util.*;
import java.util.stream.*;

class Book {
    String title;
    String author;
    String genre;
    double price;
    int yearPublished;

    public Book(String title, String author, String genre, double price, int yearPublished) {
        this.title = title;
        this.author = author;
        this.genre = genre;
        this.price = price;
        this.yearPublished = yearPublished;
    }

    public String getTitle() {
        return title;
    }

    public String getGenre() {
        return genre;
    }

    public double getPrice() {
        return price;
    }

    public int getYearPublished() {
        return yearPublished;
    }
}

class BookUtility {
    public List<Book> retrieveBookDetails_ByYearPublished(Stream<Book> bookStream, int year) {
        return bookStream.filter(book -> book.getYearPublished() == year).collect(Collectors.toList());
    }

    public List<Book> retrieveBookDetails_ByGenre(Stream<Book> bookStream, String genre) {
        return bookStream.filter(book -> book.getGenre().equalsIgnoreCase(genre)).collect(Collectors.toList());
    }

    public List<String> getTheTitlesOfCheapestBooks(Stream<Book> bookStream, double price, int range) {
        return bookStream.filter(book -> book.getPrice() >= price && book.getPrice() <= (price + range))
                .map(Book::getTitle)
                .collect(Collectors.toList());
    }
}

public class UserInterface {
    public static void main(String[] args) {
        List<Book> books = Arrays.asList(
                new Book("Book1", "Author1", "Fiction", 200, 2020),
                new Book("Book2", "Author2", "Science", 300, 2021),
                new Book("Book3", "Author3", "Fiction", 250, 2022),
                new Book("Book4", "Author4", "Romance", 150, 2020)
        );

        BookUtility bookUtility = new BookUtility();
        Stream<Book> bookStream = books.stream();

        System.out.println("Books published in 2020: ");
        List<Book> books2020 = bookUtility.retrieveBookDetails_ByYearPublished(bookStream, 2020);
        books2020.forEach(book -> System.out.println(book.getTitle()));

        System.out.println("\nBooks in Fiction genre: ");
        bookStream = books.stream(); // Reset stream
        List<Book> fictionBooks = bookUtility.retrieveBookDetails_ByGenre(bookStream, "Fiction");
        fictionBooks.forEach(book -> System.out.println(book.getTitle()));

        System.out.println("\nCheapest books within price range 200-300: ");
        bookStream = books.stream(); // Reset stream
        List<String> cheapestBooks = bookUtility.getTheTitlesOfCheapestBooks(bookStream, 200, 100);
        cheapestBooks.forEach(System.out::println);
    }
}
```

---

### **4. Strings: Sentence Manipulation**

```java
import java.util.*;

public class SentenceManipulation {

    public boolean checkSentence(String s) {
        return s.matches("[a-zA-Z ]+");
    }

    public String reverseSen(String s) {
        String[] words = s.split(" ");
        if (words.length <= 2) {
            return s; // If sentence has only two words or less, return as it is
        }
        StringBuilder sb = new StringBuilder(words[0]);
        for (int i = words.length - 2; i > 0; i--) {
            sb.append(" ").append(words[i]);
        }
        sb.append(" ").append(words[words.length - 1]);
        return sb.toString();
    }

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        SentenceManipulation sm = new SentenceManipulation();

        System.out.println("Enter a sentence:");
        String sentence = scanner.nextLine();

        if (sm.checkSentence(sentence)) {
            String reversedSentence = sm.reverseSen(sentence);
            System.out.println("Reversed sentence (except first and last words): " + reversedSentence);
        } else {
            System.out.println("Invalid sentence format. Only alphabetic characters and spaces are allowed.");
        }
    }
}
```

---

This is the structured code for each task, keeping the focus on the required functionalities and logical division of each concept. Let me know if you need further modifications!
